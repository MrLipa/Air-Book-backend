<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:23,&quot;tests&quot;:48,&quot;passes&quot;:48,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2025-06-09T18:44:57.348Z&quot;,&quot;end&quot;:&quot;2025-06-09T18:45:04.649Z&quot;,&quot;duration&quot;:7301,&quot;testsRegistered&quot;:48,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;ee540cb1-2da8-46ec-a186-1e8e4e43d8d4&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;{root}\&quot;&quot;,&quot;fullTitle&quot;:&quot;\&quot;before all\&quot; hook in \&quot;{root}\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4196,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(10000);\nconsole.log(&#x27;[SETUP] Executing erd.sql and erd.cypher...&#x27;);\nconst sqlPath = path.resolve(__dirname, &#x27;../../database/erd.sql&#x27;);\nconst sql = fs.readFileSync(sqlPath, &#x27;utf8&#x27;);\nawait pool.query(sql);\nconsole.log(&#x27;[SETUP] ✅ PostgreSQL schema + data loaded&#x27;);\nconst cypherPath = path.resolve(__dirname, &#x27;../../database/erd.cypher&#x27;);\nconst cypher = fs.readFileSync(cypherPath, &#x27;utf8&#x27;);\nconst statements = cypher\n  .split(/;\\s*\\n/)\n  .map((line) =&gt; line.trim())\n  .filter(Boolean);\nfor (const stmt of statements) {\n  await session.run(stmt);\n}\nconsole.log(&#x27;[SETUP] ✅ Neo4j schema + data loaded&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a838583b-81c2-4a2a-94c8-08bbc3083113&quot;,&quot;parentUUID&quot;:&quot;ee540cb1-2da8-46ec-a186-1e8e4e43d8d4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;{root}\&quot;&quot;,&quot;fullTitle&quot;:&quot;\&quot;after all\&quot; hook in \&quot;{root}\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:301,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(10000);\nconsole.log(&#x27;[SETUP] Executing erd.sql and erd.cypher...&#x27;);\nconst sqlPath = path.resolve(__dirname, &#x27;../../database/erd.sql&#x27;);\nconst sql = fs.readFileSync(sqlPath, &#x27;utf8&#x27;);\nawait pool.query(sql);\nconsole.log(&#x27;[SETUP] ✅ PostgreSQL schema + data loaded&#x27;);\nconst cypherPath = path.resolve(__dirname, &#x27;../../database/erd.cypher&#x27;);\nconst cypher = fs.readFileSync(cypherPath, &#x27;utf8&#x27;);\nconst statements = cypher\n  .split(/;\\s*\\n/)\n  .map((line) =&gt; line.trim())\n  .filter(Boolean);\nfor (const stmt of statements) {\n  await session.run(stmt);\n}\nconsole.log(&#x27;[SETUP] ✅ Neo4j schema + data loaded&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4279f2d9-da1e-4a01-a0f6-a7cef91924af&quot;,&quot;parentUUID&quot;:&quot;ee540cb1-2da8-46ec-a186-1e8e4e43d8d4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;2b2dd02f-dc20-4d36-a960-78cb17d24a5d&quot;,&quot;title&quot;:&quot;GET /airport/getAllAirports&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.airport.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.airport.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should respond with 200 and return a list of airports in correct format&quot;,&quot;fullTitle&quot;:&quot;GET /airport/getAllAirports should respond with 200 and return a list of airports in correct format&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:98,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .get(&#x27;/airport/getAllAirports&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(&#x27;Content-Type&#x27;, /json/)\n  .expect(200);\nconst airports = response.body;\nexpect(airports).to.be.an(&#x27;array&#x27;);\nairports.forEach((airport) =&gt; {\n  expect(airport).to.be.an(&#x27;object&#x27;);\n  expect(airport).to.have.all.keys(&#x27;airportId&#x27;, &#x27;city&#x27;, &#x27;country&#x27;, &#x27;image&#x27;);\n  expect(airport.airportId).to.be.a(&#x27;number&#x27;);\n  expect(airport.city).to.be.a(&#x27;string&#x27;);\n  expect(airport.country).to.be.a(&#x27;string&#x27;);\n  expect(airport.image).to.be.a(&#x27;string&#x27;);\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;73562ea1-2bbb-4e01-a672-479ee08fea5d&quot;,&quot;parentUUID&quot;:&quot;2b2dd02f-dc20-4d36-a960-78cb17d24a5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 403 if no token is provided&quot;,&quot;fullTitle&quot;:&quot;GET /airport/getAllAirports should return 403 if no token is provided&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app).get(&#x27;/airport/getAllAirports&#x27;).expect(403);\nexpect(response.body).to.have.property(&#x27;message&#x27;, &#x27;Missing or malformed token&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b6c7a0d2-fd23-4547-b828-d99d399ba70f&quot;,&quot;parentUUID&quot;:&quot;2b2dd02f-dc20-4d36-a960-78cb17d24a5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 403 if user has insufficient role&quot;,&quot;fullTitle&quot;:&quot;GET /airport/getAllAirports should return 403 if user has insufficient role&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .get(&#x27;/airport/getAllAirports&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${userToken}`)\n  .expect(403);\nexpect(response.body).to.have.property(&#x27;message&#x27;).that.includes(&#x27;insufficient permissions&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75f31e0c-1ad7-4c19-89bc-2cdf323a3196&quot;,&quot;parentUUID&quot;:&quot;2b2dd02f-dc20-4d36-a960-78cb17d24a5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 403 for invalid token&quot;,&quot;fullTitle&quot;:&quot;GET /airport/getAllAirports should return 403 for invalid token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .get(&#x27;/airport/getAllAirports&#x27;)\n  .set(&#x27;Authorization&#x27;, &#x27;Bearer invalid.token.here&#x27;)\n  .expect(403);\nexpect(response.body).to.have.property(&#x27;message&#x27;, &#x27;Invalid or expired token&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ed6d1840-d220-4ab7-94e9-0eb9eece2946&quot;,&quot;parentUUID&quot;:&quot;2b2dd02f-dc20-4d36-a960-78cb17d24a5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;73562ea1-2bbb-4e01-a672-479ee08fea5d&quot;,&quot;b6c7a0d2-fd23-4547-b828-d99d399ba70f&quot;,&quot;75f31e0c-1ad7-4c19-89bc-2cdf323a3196&quot;,&quot;ed6d1840-d220-4ab7-94e9-0eb9eece2946&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:123,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;88135d5b-0e34-4a26-9661-4d4452195cd6&quot;,&quot;title&quot;:&quot;Flight Routes&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.flight.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.flight.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;07d6ff62-a947-4fb1-b182-a369e871766c&quot;,&quot;title&quot;:&quot;GET /flight/getAllFlights&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.flight.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.flight.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return all flights with 200&quot;,&quot;fullTitle&quot;:&quot;Flight Routes GET /flight/getAllFlights should return all flights with 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:54,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .get(&#x27;/flight/getAllFlights&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`);\nexpect(res.status).to.equal(200);\nexpect(res.body).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cbc9dcf4-c2f6-4560-83f1-f0cdf65043f3&quot;,&quot;parentUUID&quot;:&quot;07d6ff62-a947-4fb1-b182-a369e871766c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 403 if no token is provided&quot;,&quot;fullTitle&quot;:&quot;Flight Routes GET /flight/getAllFlights should return 403 if no token is provided&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).get(&#x27;/flight/getAllFlights&#x27;);\nexpect(res.status).to.equal(403);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a0aa3f62-77a8-459b-8fa3-f92bc6fd6455&quot;,&quot;parentUUID&quot;:&quot;07d6ff62-a947-4fb1-b182-a369e871766c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cbc9dcf4-c2f6-4560-83f1-f0cdf65043f3&quot;,&quot;a0aa3f62-77a8-459b-8fa3-f92bc6fd6455&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:59,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;03dc459d-32ca-48a5-97b9-32d63682d32d&quot;,&quot;title&quot;:&quot;POST /flight/searchFlights&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.flight.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.flight.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return flights from a city&quot;,&quot;fullTitle&quot;:&quot;Flight Routes POST /flight/searchFlights should return flights from a city&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:235,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).post(&#x27;/flight/searchFlights&#x27;).send({ cityFrom: &#x27;Warsaw&#x27; });\nexpect(res.status).to.equal(200);\nexpect(res.body).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99198484-7218-4b9a-ad18-5582775719ed&quot;,&quot;parentUUID&quot;:&quot;03dc459d-32ca-48a5-97b9-32d63682d32d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return flights to a city&quot;,&quot;fullTitle&quot;:&quot;Flight Routes POST /flight/searchFlights should return flights to a city&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).post(&#x27;/flight/searchFlights&#x27;).send({ cityTo: &#x27;London&#x27; });\nexpect(res.status).to.equal(200);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aa5260da-623f-422a-b412-f9a64f5c6253&quot;,&quot;parentUUID&quot;:&quot;03dc459d-32ca-48a5-97b9-32d63682d32d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;99198484-7218-4b9a-ad18-5582775719ed&quot;,&quot;aa5260da-623f-422a-b412-f9a64f5c6253&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:342,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;839a0b0e-4cc1-42e8-bc28-87c049c0d539&quot;,&quot;title&quot;:&quot;POST /flight/getFlightsByIds&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.flight.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.flight.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return flights for given IDs&quot;,&quot;fullTitle&quot;:&quot;Flight Routes POST /flight/getFlightsByIds should return flights for given IDs&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:67,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(5000);\nconst res = await request(app)\n  .post(&#x27;/flight/getFlightsByIds&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ flightIds: [1] });\nexpect(res.status).to.equal(200);\nexpect(res.body).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2e552d56-834f-4c3c-a571-f6a05f23163a&quot;,&quot;parentUUID&quot;:&quot;839a0b0e-4cc1-42e8-bc28-87c049c0d539&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2e552d56-834f-4c3c-a571-f6a05f23163a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:67,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d52805c5-cf58-4f18-9b87-32f7f222e385&quot;,&quot;title&quot;:&quot;GET /flight/getFlightsByUserId/:userId&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.flight.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.flight.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return user reservations and flights&quot;,&quot;fullTitle&quot;:&quot;Flight Routes GET /flight/getFlightsByUserId/:userId should return user reservations and flights&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:162,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(15000);\nconst res = await request(app)\n  .get(&#x27;/flight/getFlightsByUserId/1&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`);\nexpect(res.status).to.equal(200);\nexpect(res.body).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b08803c5-7379-4bb0-916f-26e4501d0d53&quot;,&quot;parentUUID&quot;:&quot;d52805c5-cf58-4f18-9b87-32f7f222e385&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for invalid userId&quot;,&quot;fullTitle&quot;:&quot;Flight Routes GET /flight/getFlightsByUserId/:userId should return 400 for invalid userId&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .get(&#x27;/flight/getFlightsByUserId/abc&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`);\nexpect(res.status).to.equal(400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;088bf74a-ddc3-45f3-938a-8decdf610eca&quot;,&quot;parentUUID&quot;:&quot;d52805c5-cf58-4f18-9b87-32f7f222e385&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b08803c5-7379-4bb0-916f-26e4501d0d53&quot;,&quot;088bf74a-ddc3-45f3-938a-8decdf610eca&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:169,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;73c0914d-d3d4-4df1-a560-cda00a6db35a&quot;,&quot;title&quot;:&quot;PATCH /flight/patchFlightById/:flightId&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.flight.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.flight.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should patch flight fields and return 200&quot;,&quot;fullTitle&quot;:&quot;Flight Routes PATCH /flight/patchFlightById/:flightId should patch flight fields and return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .patch(&#x27;/flight/patchFlightById/1&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ price: 999 });\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property(&#x27;message&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f55ebc63-3631-4c0a-9d8a-4a4ad8fc8a53&quot;,&quot;parentUUID&quot;:&quot;73c0914d-d3d4-4df1-a560-cda00a6db35a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f55ebc63-3631-4c0a-9d8a-4a4ad8fc8a53&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:107,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ce89fdb4-a123-4602-a0b6-6e81331c7263&quot;,&quot;title&quot;:&quot;POST /login&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.login.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.login.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;✅ should login successfully with correct credentials&quot;,&quot;fullTitle&quot;:&quot;POST /login ✅ should login successfully with correct credentials&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:262,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).post(&#x27;/login&#x27;).send({\n  email: testUser.email,\n  password: testUser.password,\n});\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property(&#x27;accessToken&#x27;);\nexpect(res.body).to.have.property(&#x27;userId&#x27;);\nexpect(res.body).to.have.property(&#x27;role&#x27;);\nexpect(res.headers[&#x27;set-cookie&#x27;]).to.exist;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a55b196b-b78c-4ea2-aa31-426196470c5e&quot;,&quot;parentUUID&quot;:&quot;ce89fdb4-a123-4602-a0b6-6e81331c7263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;❌ should return 400 if email is missing&quot;,&quot;fullTitle&quot;:&quot;POST /login ❌ should return 400 if email is missing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).post(&#x27;/login&#x27;).send({ password: testUser.password });\nexpect(res.status).to.equal(400);\nexpect(res.body.message).to.include(&#x27;required&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;88b405be-2a23-4b4a-8963-528aae425174&quot;,&quot;parentUUID&quot;:&quot;ce89fdb4-a123-4602-a0b6-6e81331c7263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;❌ should return 400 if password is missing&quot;,&quot;fullTitle&quot;:&quot;POST /login ❌ should return 400 if password is missing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).post(&#x27;/login&#x27;).send({ email: testUser.email });\nexpect(res.status).to.equal(400);\nexpect(res.body.message).to.include(&#x27;required&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a3310d8b-f76c-455f-8cf6-b932625333b8&quot;,&quot;parentUUID&quot;:&quot;ce89fdb4-a123-4602-a0b6-6e81331c7263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;❌ should return 401 if email is incorrect&quot;,&quot;fullTitle&quot;:&quot;POST /login ❌ should return 401 if email is incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:36,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).post(&#x27;/login&#x27;).send({\n  email: &#x27;wrong@example.com&#x27;,\n  password: testUser.password,\n});\nexpect(res.status).to.equal(401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fafeb5d6-c5cb-45ad-a8d4-25e850cbdf8e&quot;,&quot;parentUUID&quot;:&quot;ce89fdb4-a123-4602-a0b6-6e81331c7263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;❌ should return 401 if password is incorrect&quot;,&quot;fullTitle&quot;:&quot;POST /login ❌ should return 401 if password is incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:90,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).post(&#x27;/login&#x27;).send({\n  email: testUser.email,\n  password: &#x27;WrongPassword!&#x27;,\n});\nexpect(res.status).to.equal(401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec4cd54d-d299-4298-a1ff-baf39d2b5809&quot;,&quot;parentUUID&quot;:&quot;ce89fdb4-a123-4602-a0b6-6e81331c7263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a55b196b-b78c-4ea2-aa31-426196470c5e&quot;,&quot;88b405be-2a23-4b4a-8963-528aae425174&quot;,&quot;a3310d8b-f76c-455f-8cf6-b932625333b8&quot;,&quot;fafeb5d6-c5cb-45ad-a8d4-25e850cbdf8e&quot;,&quot;ec4cd54d-d299-4298-a1ff-baf39d2b5809&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:401,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;056622ff-edc0-4d5f-a56a-0cda847c1087&quot;,&quot;title&quot;:&quot;GET /logout&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.logout.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.logout.test.mjs&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;GET /logout\&quot;&quot;,&quot;fullTitle&quot;:&quot;GET /logout \&quot;before all\&quot; hook in \&quot;GET /logout\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:32,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const payload = {\n  userInfo: {\n    userId,\n    email: testUser.email,\n    role: testUser.role,\n  },\n};\nrefreshToken = jwt.sign(payload, process.env.REFRESH_TOKEN_SECRET, {\n  expiresIn: process.env.REFRESH_TOKEN_EXPIRY || &#x27;7d&#x27;,\n});\nawait pool.query(&#x27;INSERT INTO air_book.user_tokens (user_id, refresh_token) VALUES ($1, $2)&#x27;, [\n  userId,\n  refreshToken,\n]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b5df08b-4d12-46b5-8086-25ba5fad3b7d&quot;,&quot;parentUUID&quot;:&quot;056622ff-edc0-4d5f-a56a-0cda847c1087&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;GET /logout\&quot;&quot;,&quot;fullTitle&quot;:&quot;GET /logout \&quot;after all\&quot; hook in \&quot;GET /logout\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:28,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;try {\n  await pool.query(&#x27;DELETE FROM air_book.user_tokens WHERE refresh_token = $1&#x27;, [refreshToken]);\n} catch (err) {\n  console.error(&#x27;[AFTER] Cleanup error:&#x27;, err.message);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;83f0ee23-7a2c-44a9-927b-e5f8bf9a1d97&quot;,&quot;parentUUID&quot;:&quot;056622ff-edc0-4d5f-a56a-0cda847c1087&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;✅ should clear the cookie and remove the token from DB&quot;,&quot;fullTitle&quot;:&quot;GET /logout ✅ should clear the cookie and remove the token from DB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:64,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .get(&#x27;/logout&#x27;)\n  .set(&#x27;Cookie&#x27;, [`jwt=${refreshToken}`]);\nexpect(res.status).to.equal(200);\nexpect(res.body.message).to.equal(&#x27;User logout&#x27;);\nexpect(res.headers[&#x27;set-cookie&#x27;]).to.exist;\nexpect(res.headers[&#x27;set-cookie&#x27;][0]).to.include(&#x27;jwt=;&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b3e42849-b816-4103-b21c-616356d46f9f&quot;,&quot;parentUUID&quot;:&quot;056622ff-edc0-4d5f-a56a-0cda847c1087&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;✅ should return 204 if no cookie is present&quot;,&quot;fullTitle&quot;:&quot;GET /logout ✅ should return 204 if no cookie is present&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).get(&#x27;/logout&#x27;);\nexpect(res.status).to.equal(204);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;845330a5-ba11-486e-892c-d353c02c5dbf&quot;,&quot;parentUUID&quot;:&quot;056622ff-edc0-4d5f-a56a-0cda847c1087&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;❌ should return 403 if token is malformed&quot;,&quot;fullTitle&quot;:&quot;GET /logout ❌ should return 403 if token is malformed&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).get(&#x27;/logout&#x27;).set(&#x27;Cookie&#x27;, [&#x27;jwt=invalid_token_value&#x27;]);\nexpect(res.status).to.equal(403);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6598dd09-d18c-4998-8cff-2b04599a2c0b&quot;,&quot;parentUUID&quot;:&quot;056622ff-edc0-4d5f-a56a-0cda847c1087&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b3e42849-b816-4103-b21c-616356d46f9f&quot;,&quot;845330a5-ba11-486e-892c-d353c02c5dbf&quot;,&quot;6598dd09-d18c-4998-8cff-2b04599a2c0b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:75,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9330222c-15c8-4ebe-97d3-a340941b6052&quot;,&quot;title&quot;:&quot;GET /refreshToken&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.refreshToken.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.refreshToken.test.mjs&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;GET /refreshToken\&quot;&quot;,&quot;fullTitle&quot;:&quot;GET /refreshToken \&quot;before all\&quot; hook in \&quot;GET /refreshToken\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:59,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await pool.query(&#x27;DELETE FROM air_book.user_tokens WHERE user_id = $1&#x27;, [userId]);\nconst payload = {\n  userInfo: {\n    userId,\n    email: &#x27;xavier@gmail.com&#x27;,\n    role: &#x27;admin&#x27;,\n  },\n};\nrefreshToken = jwt.sign(payload, process.env.REFRESH_TOKEN_SECRET, {\n  expiresIn: process.env.REFRESH_TOKEN_EXPIRY || &#x27;7d&#x27;,\n});\nawait pool.query(&#x27;INSERT INTO air_book.user_tokens (user_id, refresh_token) VALUES ($1, $2)&#x27;, [\n  userId,\n  refreshToken,\n]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e1ba171-a5f1-4e8b-9806-10f3e6bbbd99&quot;,&quot;parentUUID&quot;:&quot;9330222c-15c8-4ebe-97d3-a340941b6052&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;GET /refreshToken\&quot;&quot;,&quot;fullTitle&quot;:&quot;GET /refreshToken \&quot;after all\&quot; hook in \&quot;GET /refreshToken\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;try {\n  if (refreshToken) {\n    await pool.query(&#x27;DELETE FROM air_book.user_tokens WHERE refresh_token = $1&#x27;, [\n      refreshToken,\n    ]);\n  }\n} catch (err) {\n  console.error(&#x27;[AFTER] Cleanup error:&#x27;, err.message);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe8b67a0-8203-4eaf-9567-64d7f2916675&quot;,&quot;parentUUID&quot;:&quot;9330222c-15c8-4ebe-97d3-a340941b6052&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;✅ should return new access token for valid refresh token&quot;,&quot;fullTitle&quot;:&quot;GET /refreshToken ✅ should return new access token for valid refresh token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:35,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .get(&#x27;/refreshToken&#x27;)\n  .set(&#x27;Cookie&#x27;, [`jwt=${refreshToken}`]);\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property(&#x27;accessToken&#x27;);\nexpect(res.body).to.have.property(&#x27;userId&#x27;);\nexpect(res.body).to.have.property(&#x27;role&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7f18c284-2a5b-4f03-b499-c64b57ed59d9&quot;,&quot;parentUUID&quot;:&quot;9330222c-15c8-4ebe-97d3-a340941b6052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;❌ should return 401 if no cookie is present&quot;,&quot;fullTitle&quot;:&quot;GET /refreshToken ❌ should return 401 if no cookie is present&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).get(&#x27;/refreshToken&#x27;);\nexpect(res.status).to.equal(401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;992de169-5b4c-4052-8b67-e9de584ac042&quot;,&quot;parentUUID&quot;:&quot;9330222c-15c8-4ebe-97d3-a340941b6052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;❌ should return 403 if token is invalid&quot;,&quot;fullTitle&quot;:&quot;GET /refreshToken ❌ should return 403 if token is invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).get(&#x27;/refreshToken&#x27;).set(&#x27;Cookie&#x27;, [&#x27;jwt=invalid_token_value&#x27;]);\nexpect(res.status).to.equal(403);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2eb1a68b-ec11-4b90-94a6-fc2bde5c54c4&quot;,&quot;parentUUID&quot;:&quot;9330222c-15c8-4ebe-97d3-a340941b6052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;❌ should return 403 if user not found in DB&quot;,&quot;fullTitle&quot;:&quot;GET /refreshToken ❌ should return 403 if user not found in DB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:34,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const fakePayload = {\n  userInfo: {\n    userId: 9999999,\n    email: &#x27;nonexistent@example.com&#x27;,\n    role: &#x27;user&#x27;,\n  },\n};\nconst fakeToken = jwt.sign(fakePayload, process.env.REFRESH_TOKEN_SECRET, {\n  expiresIn: &#x27;1h&#x27;,\n});\nconst res = await request(app)\n  .get(&#x27;/refreshToken&#x27;)\n  .set(&#x27;Cookie&#x27;, [`jwt=${fakeToken}`]);\nexpect(res.status).to.equal(403);\nexpect(res.body.message).to.equal(&#x27;User not found&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ef00f18-1c52-487b-95b3-b3c04fbc83ed&quot;,&quot;parentUUID&quot;:&quot;9330222c-15c8-4ebe-97d3-a340941b6052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7f18c284-2a5b-4f03-b499-c64b57ed59d9&quot;,&quot;992de169-5b4c-4052-8b67-e9de584ac042&quot;,&quot;2eb1a68b-ec11-4b90-94a6-fc2bde5c54c4&quot;,&quot;8ef00f18-1c52-487b-95b3-b3c04fbc83ed&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:79,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a4220a8b-a577-44af-8071-ce74193ecc65&quot;,&quot;title&quot;:&quot;POST /register&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.register.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.register.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;✅ should register a new user and return 201&quot;,&quot;fullTitle&quot;:&quot;POST /register ✅ should register a new user and return 201&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:129,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).post(&#x27;/register&#x27;).send(userData);\nexpect(res.status).to.equal(201);\nexpect(res.body.message).to.include(userData.email);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;78a3a296-de9f-48b9-99e2-f591cd5903c3&quot;,&quot;parentUUID&quot;:&quot;a4220a8b-a577-44af-8071-ce74193ecc65&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;❌ should return 409 if user with email already exists&quot;,&quot;fullTitle&quot;:&quot;POST /register ❌ should return 409 if user with email already exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:34,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).post(&#x27;/register&#x27;).send(userData);\nexpect(res.status).to.equal(409);\nexpect(res.body.message).to.equal(&#x27;User with this email already exists.&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1a9ee366-a190-4fe6-9499-6e88fda1a442&quot;,&quot;parentUUID&quot;:&quot;a4220a8b-a577-44af-8071-ce74193ecc65&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;❌ should return 400 if fields are missing&quot;,&quot;fullTitle&quot;:&quot;POST /register ❌ should return 400 if fields are missing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app).post(&#x27;/register&#x27;).send({\n  email: &#x27;missing@example.com&#x27;,\n  password: &#x27;Test123!&#x27;,\n});\nexpect(res.status).to.equal(400);\nexpect(res.body.message).to.include(&#x27;\&quot;firstName\&quot; is required&#x27;); // zakładamy, że używasz Joi lub podobnej walidacji&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d93258e3-3ed7-41f9-8544-14f07c12cc7c&quot;,&quot;parentUUID&quot;:&quot;a4220a8b-a577-44af-8071-ce74193ecc65&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;78a3a296-de9f-48b9-99e2-f591cd5903c3&quot;,&quot;1a9ee366-a190-4fe6-9499-6e88fda1a442&quot;,&quot;d93258e3-3ed7-41f9-8544-14f07c12cc7c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:171,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4b103c32-a41e-4324-ba82-2d0580160fe9&quot;,&quot;title&quot;:&quot;User endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;f9faa342-3402-4620-8ff4-de252c1132a9&quot;,&quot;title&quot;:&quot;GET /user/getAllUsers&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return a list of users for admin&quot;,&quot;fullTitle&quot;:&quot;User endpoints GET /user/getAllUsers should return a list of users for admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:37,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .get(&#x27;/user/getAllUsers&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(200);\nexpect(res.body).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;591176de-11b9-468e-ac75-fdd876a6baa8&quot;,&quot;parentUUID&quot;:&quot;f9faa342-3402-4620-8ff4-de252c1132a9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 403 for non-admin&quot;,&quot;fullTitle&quot;:&quot;User endpoints GET /user/getAllUsers should return 403 for non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:17,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .get(&#x27;/user/getAllUsers&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${userToken}`)\n  .expect(403);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;609ac5c1-7015-4cc9-b079-c5a0f157714b&quot;,&quot;parentUUID&quot;:&quot;f9faa342-3402-4620-8ff4-de252c1132a9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;591176de-11b9-468e-ac75-fdd876a6baa8&quot;,&quot;609ac5c1-7015-4cc9-b079-c5a0f157714b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:54,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f36e4d5a-d0cd-4a10-84ee-1dfd3b31b07f&quot;,&quot;title&quot;:&quot;GET /user/getUserIdByEmail/:email&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return userId for existing email&quot;,&quot;fullTitle&quot;:&quot;User endpoints GET /user/getUserIdByEmail/:email should return userId for existing email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:53,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .get(&#x27;/user/getUserIdByEmail/xavier@gmail.com&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(200);\nexpect(res.body).to.have.property(&#x27;userId&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b677e4e-55b0-47bc-8baa-5c0bcc04438d&quot;,&quot;parentUUID&quot;:&quot;f36e4d5a-d0cd-4a10-84ee-1dfd3b31b07f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for unknown email&quot;,&quot;fullTitle&quot;:&quot;User endpoints GET /user/getUserIdByEmail/:email should return 404 for unknown email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:44,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .get(&#x27;/user/getUserIdByEmail/unknown@example.com&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(404);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2e04a88a-f588-4ff9-b952-93c9c6024b6d&quot;,&quot;parentUUID&quot;:&quot;f36e4d5a-d0cd-4a10-84ee-1dfd3b31b07f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3b677e4e-55b0-47bc-8baa-5c0bcc04438d&quot;,&quot;2e04a88a-f588-4ff9-b952-93c9c6024b6d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:97,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;dccd9c02-fa2e-4cce-a6e3-7ebba516eaf2&quot;,&quot;title&quot;:&quot;GET /user/getUserById/:userId&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return user details&quot;,&quot;fullTitle&quot;:&quot;User endpoints GET /user/getUserById/:userId should return user details&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .get(&#x27;/user/getUserById/1&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(200);\nexpect(res.body).to.have.property(&#x27;userId&#x27;, 1);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e942ae08-2679-4093-884d-4d36c47b9269&quot;,&quot;parentUUID&quot;:&quot;dccd9c02-fa2e-4cce-a6e3-7ebba516eaf2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existing user&quot;,&quot;fullTitle&quot;:&quot;User endpoints GET /user/getUserById/:userId should return 404 for non-existing user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:38,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .get(&#x27;/user/getUserById/9999&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(404);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f7c37a9-0d16-42ad-95f8-761013898382&quot;,&quot;parentUUID&quot;:&quot;dccd9c02-fa2e-4cce-a6e3-7ebba516eaf2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e942ae08-2679-4093-884d-4d36c47b9269&quot;,&quot;0f7c37a9-0d16-42ad-95f8-761013898382&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:84,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a881a701-c445-4e60-a917-dda8b8f37b07&quot;,&quot;title&quot;:&quot;POST /user/createNewUser&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a new user&quot;,&quot;fullTitle&quot;:&quot;User endpoints POST /user/createNewUser should create a new user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:42,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .post(&#x27;/user/createNewUser&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .send(newUser)\n  .expect(201);\nexpect(res.body).to.have.property(&#x27;userId&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e81c8766-ae79-4a37-8cb0-7982499feaf6&quot;,&quot;parentUUID&quot;:&quot;a881a701-c445-4e60-a917-dda8b8f37b07&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 if required fields missing&quot;,&quot;fullTitle&quot;:&quot;User endpoints POST /user/createNewUser should return 400 if required fields missing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const badUser = { ...newUser };\ndelete badUser.email;\nawait request(app)\n  .post(&#x27;/user/createNewUser&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .send(badUser)\n  .expect(400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7057ae8a-a81e-4cc2-88e1-176f9d3281a9&quot;,&quot;parentUUID&quot;:&quot;a881a701-c445-4e60-a917-dda8b8f37b07&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e81c8766-ae79-4a37-8cb0-7982499feaf6&quot;,&quot;7057ae8a-a81e-4cc2-88e1-176f9d3281a9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:50,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;569d352e-634c-469f-ae26-dec13ab007df&quot;,&quot;title&quot;:&quot;PUT /user/updateUserById/:userId&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should update user details&quot;,&quot;fullTitle&quot;:&quot;User endpoints PUT /user/updateUserById/:userId should update user details&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:96,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updated = {\n  firstName: &#x27;Updated&#x27;,\n  lastName: &#x27;User&#x27;,\n  email: &#x27;updated@example.com&#x27;,\n  password: &#x27;newpass&#x27;,\n  image: &#x27;img.jpg&#x27;,\n  phone: &#x27;987654321&#x27;,\n  address: &#x27;Updated Street&#x27;,\n  description: &#x27;Updated desc&#x27;,\n  role: &#x27;user&#x27;,\n};\nconst res = await request(app)\n  .put(&#x27;/user/updateUserById/2&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .send(updated)\n  .expect(200);\nexpect(res.body).to.have.property(&#x27;message&#x27;, &#x27;User updated&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9c2ed3eb-c973-4afb-858c-5cd010f4f570&quot;,&quot;parentUUID&quot;:&quot;569d352e-634c-469f-ae26-dec13ab007df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 if fields are empty&quot;,&quot;fullTitle&quot;:&quot;User endpoints PUT /user/updateUserById/:userId should return 400 if fields are empty&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .put(&#x27;/user/updateUserById/2&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .send({})\n  .expect(400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d0a530f5-7b66-4406-8b34-2fbca5235b35&quot;,&quot;parentUUID&quot;:&quot;569d352e-634c-469f-ae26-dec13ab007df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9c2ed3eb-c973-4afb-858c-5cd010f4f570&quot;,&quot;d0a530f5-7b66-4406-8b34-2fbca5235b35&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:102,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f9d738ba-ff64-4978-8a3c-12e0ba21abf3&quot;,&quot;title&quot;:&quot;PATCH /user/patchUserById/:userId&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should patch user details&quot;,&quot;fullTitle&quot;:&quot;User endpoints PATCH /user/patchUserById/:userId should patch user details&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:40,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .patch(&#x27;/user/patchUserById/2&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .send({ description: &#x27;patched&#x27; })\n  .expect(200);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0e8efe9c-0844-475a-a5f9-f3b329a02f7e&quot;,&quot;parentUUID&quot;:&quot;f9d738ba-ff64-4978-8a3c-12e0ba21abf3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 if no valid fields&quot;,&quot;fullTitle&quot;:&quot;User endpoints PATCH /user/patchUserById/:userId should return 400 if no valid fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .patch(&#x27;/user/patchUserById/2&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .send({})\n  .expect(400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;47aa0902-38ca-45dd-b963-68700803c110&quot;,&quot;parentUUID&quot;:&quot;f9d738ba-ff64-4978-8a3c-12e0ba21abf3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0e8efe9c-0844-475a-a5f9-f3b329a02f7e&quot;,&quot;47aa0902-38ca-45dd-b963-68700803c110&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:46,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;39206d6a-485c-4bfe-9cb0-44ee837ea651&quot;,&quot;title&quot;:&quot;DELETE /user/deleteUserById/:userId&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should delete a user&quot;,&quot;fullTitle&quot;:&quot;User endpoints DELETE /user/deleteUserById/:userId should delete a user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:35,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .delete(&#x27;/user/deleteUserById/2&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(200);\nexpect(res.body).to.have.property(&#x27;message&#x27;, &#x27;User deleted&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;71ce5e5d-ac41-4344-b552-6e9fbf967066&quot;,&quot;parentUUID&quot;:&quot;39206d6a-485c-4bfe-9cb0-44ee837ea651&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 if user not found&quot;,&quot;fullTitle&quot;:&quot;User endpoints DELETE /user/deleteUserById/:userId should return 404 if user not found&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:35,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .delete(&#x27;/user/deleteUserById/9999&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(404);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a65f98ba-c973-489b-8e0a-e033acbb595a&quot;,&quot;parentUUID&quot;:&quot;39206d6a-485c-4bfe-9cb0-44ee837ea651&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;71ce5e5d-ac41-4344-b552-6e9fbf967066&quot;,&quot;a65f98ba-c973-489b-8e0a-e033acbb595a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:70,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4e4c0dbd-832b-4369-877b-19b6e8a46ce3&quot;,&quot;title&quot;:&quot;POST /user/createNotification&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a notification&quot;,&quot;fullTitle&quot;:&quot;User endpoints POST /user/createNotification should create a notification&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:38,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .post(&#x27;/user/createNotification&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .send({ userId: 1, message: &#x27;Hello&#x27; })\n  .expect(201);\nexpect(res.body).to.have.property(&#x27;notification&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4589f2a-21ed-4f86-bd9c-f17788c46dc8&quot;,&quot;parentUUID&quot;:&quot;4e4c0dbd-832b-4369-877b-19b6e8a46ce3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a4589f2a-21ed-4f86-bd9c-f17788c46dc8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:38,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;72314499-c502-4a07-ab61-ed49dbfdb774&quot;,&quot;title&quot;:&quot;POST /user/createReservation&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a reservation&quot;,&quot;fullTitle&quot;:&quot;User endpoints POST /user/createReservation should create a reservation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:196,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .post(&#x27;/user/createReservation&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .send({ userId: 1, flightId: 1 })\n  .expect(201);\nexpect(res.body).to.have.property(&#x27;reservation&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f72ddaa-0134-4de6-99aa-d49b45988e83&quot;,&quot;parentUUID&quot;:&quot;72314499-c502-4a07-ab61-ed49dbfdb774&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 if required fields missing&quot;,&quot;fullTitle&quot;:&quot;User endpoints POST /user/createReservation should return 400 if required fields missing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .post(&#x27;/user/createReservation&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .send({ userId: 2 })\n  .expect(400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a139d07c-13da-4341-a2fc-805d162b9eb0&quot;,&quot;parentUUID&quot;:&quot;72314499-c502-4a07-ab61-ed49dbfdb774&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8f72ddaa-0134-4de6-99aa-d49b45988e83&quot;,&quot;a139d07c-13da-4341-a2fc-805d162b9eb0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:205,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0c536985-5f53-4b32-87ec-7b32804c2090&quot;,&quot;title&quot;:&quot;DELETE /user/deleteReservationById/:reservationId&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should delete a reservation&quot;,&quot;fullTitle&quot;:&quot;User endpoints DELETE /user/deleteReservationById/:reservationId should delete a reservation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:170,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .delete(&#x27;/user/deleteReservationById/1&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(200);\nexpect(res.body.message).to.include(&#x27;Reservation deleted&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0c631942-9f35-4ddb-9e83-69078031d20a&quot;,&quot;parentUUID&quot;:&quot;0c536985-5f53-4b32-87ec-7b32804c2090&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 if reservation not found&quot;,&quot;fullTitle&quot;:&quot;User endpoints DELETE /user/deleteReservationById/:reservationId should return 404 if reservation not found&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:36,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .delete(&#x27;/user/deleteReservationById/9999&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(404);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;48ee2ed6-1fac-4e19-a2cd-3e53fded39d5&quot;,&quot;parentUUID&quot;:&quot;0c536985-5f53-4b32-87ec-7b32804c2090&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0c631942-9f35-4ddb-9e83-69078031d20a&quot;,&quot;48ee2ed6-1fac-4e19-a2cd-3e53fded39d5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:206,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d2930c30-2781-4d33-94f2-7d81385b818d&quot;,&quot;title&quot;:&quot;GET /user/getNotificationsByUserId/:userId&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\tests\\integration\\app.user.test.mjs&quot;,&quot;file&quot;:&quot;\\tests\\integration\\app.user.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return user notifications&quot;,&quot;fullTitle&quot;:&quot;User endpoints GET /user/getNotificationsByUserId/:userId should return user notifications&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:40,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .get(&#x27;/user/getNotificationsByUserId/1&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(200);\nexpect(res.body).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e547dcde-1cf4-4e82-82ba-b2fb3aae8782&quot;,&quot;parentUUID&quot;:&quot;d2930c30-2781-4d33-94f2-7d81385b818d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 if userId is invalid&quot;,&quot;fullTitle&quot;:&quot;User endpoints GET /user/getNotificationsByUserId/:userId should return 400 if userId is invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .get(&#x27;/user/getNotificationsByUserId/abc&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${adminToken}`)\n  .expect(400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa7335b7-56f7-4dba-89a3-4fb79859e041&quot;,&quot;parentUUID&quot;:&quot;d2930c30-2781-4d33-94f2-7d81385b818d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e547dcde-1cf4-4e82-82ba-b2fb3aae8782&quot;,&quot;fa7335b7-56f7-4dba-89a3-4fb79859e041&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:49,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.8.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;test-report&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;logs&quot;,&quot;reportFilename&quot;:&quot;test-report&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;test-report&quot;,&quot;reportDir&quot;:&quot;logs&quot;,&quot;reportTitle&quot;:&quot;backend&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;logs\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\logs\\test-report.json&quot;,&quot;htmlFile&quot;:&quot;C:\\Users\\tomek\\Desktop\\HomeAssistant\\air-book\\backend\\logs\\test-report.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>